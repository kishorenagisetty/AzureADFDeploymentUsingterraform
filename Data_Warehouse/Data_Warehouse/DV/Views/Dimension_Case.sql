CREATE VIEW [DV].[Dimension_Case] AS SELECT
[CaseHash]
,[CaseID]
,[CaseDevelopmentStatus]
,[CaseModuleStatus]
,[CaseStatus]
,[PrimaryBenefit]
,[LeaveReason]
,[WorkRedinessStatus]
,[FrequencyOfContact]
,[TranOwnerUserId]
,[Outcome]
,[PackIssued]
,[CredReceipt]
,[SustainedEarnings]
,[ToWork]
,[EnglandWales]
,[WorkingAge]
,[DwpEmployment]
,[NotInControlGroupOrPublicSectorComparator]
,[EmployabilityExoffender]
,[EligibilityConfirmed]
,[EmploymentInterests]
,[ExitReasonOther]
,[OnwardDestination]
,[OnwardDestinationOther]
,[LeftReason]
,[LeftReasonOther]
,[LeftStage]
,[LeftStageOther]
,[DidNotStartReason]
,[DidNotStartReasonOther]
,[SignedPrivacyNoticeUploaded]
,[PrivacyRightsExcercised]
,[PrivacyRightsDetails]
,[DisengagedReason]
FROM (
		SELECT
		[CaseHash]
		,row_number() OVER (PARTITION BY [CaseHash] ORDER BY [CaseHash]) rn
		,[CaseID]
		,[CaseDevelopmentStatus]
		,[CaseModuleStatus]
		,[CaseStatus]
		,[PrimaryBenefit]
		,[LeaveReason]
		,[WorkRedinessStatus]
		,[FrequencyOfContact]
		,[TranOwnerUserId]
		,[Outcome]
		,[PackIssued]
		,[CredReceipt]
		,[SustainedEarnings]
		,[ToWork]
		,[EnglandWales]
		,[WorkingAge]
		,[DwpEmployment]
		,[NotInControlGroupOrPublicSectorComparator]
		,[EmployabilityExoffender]
		,[EligibilityConfirmed]
		,[EmploymentInterests]
		,[ExitReasonOther]
		,[OnwardDestination]
		,[OnwardDestinationOther]
		,[LeftReason]
		,[LeftReasonOther]
		,[LeftStage]
		,[LeftStageOther]
		,[DidNotStartReason]
		,[DidNotStartReasonOther]
		,[SignedPrivacyNoticeUploaded]
		,[PrivacyRightsExcercised]
		,[PrivacyRightsDetails]
		,[DisengagedReason]
		FROM [DV].[Base_Case]
		) src
WHERE (rn = 1);
GO

