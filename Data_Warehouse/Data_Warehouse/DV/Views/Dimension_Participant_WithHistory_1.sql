CREATE VIEW [DV].[Dimension_Participant_WithHistory]
AS SELECT
[ParticipantHash]
,[ParticipantHash_Hub]
,[RecordSource]
,[FullName]
,[Title]
,[FirstName]
,[MiddleName]
,[LastName]
,[KnownAs]
,[DateOfBirth]
,[NationalInsuranceNo]
,[ValidSMS]
,[SMSOptOut]
,[EmailOptOut]
,[LeaveMessage]
,[HasCriminalConviction]
,[IsDriver]
,[BetterOffCalculationStatus]
,[HasOwnTransport]
,[MarketingPermissions]
,[HasUpToDateCV]
,[AddressLine1]
,[AddressLine2]
,[Locality]
,[Town]
,[County]
,[PostCode]
,[PostCodeSector]
,[TelephoneHome]
,[TelephoneMobile]
,[TelephoneWork]
,[EmailWork]
,[EmailHome]
,[PreferredCommunicationMethod]
,[ContactStatus]
,[SexualOrientation]
,[Gender]
,[Ethnicity]
,[ValidFrom]
,[ValidTo]
,[IsCurrent]
FROM (
		SELECT
		 [ParticipantHash]
		,row_number() OVER (PARTITION BY [ParticipantHash] ORDER BY [ParticipantHash]) rn
		,[ParticipantHash_Hub]
		,[RecordSource]
		,[FullName]
		,[Title]
		,[FirstName]
		,[MiddleName]
		,[LastName]
		,[KnownAs]
		,[DateOfBirth]
		,[NationalInsuranceNo]
		,[ValidSMS]
		,[SMSOptOut]
		,[EmailOptOut]
		,[LeaveMessage]
		,[HasCriminalConviction]
		,[IsDriver]
		,[BetterOffCalculationStatus]
		,[HasOwnTransport]
		,[MarketingPermissions]
		,[HasUpToDateCV]
		,[AddressLine1]
		,[AddressLine2]
		,[Locality]
		,[Town]
		,[County]
		,[PostCode]
		,[PostCodeSector]
		,[TelephoneHome]
		,[TelephoneMobile]
		,[TelephoneWork]
		,[EmailWork]
		,[EmailHome]
		,[PreferredCommunicationMethod]
		,[ContactStatus]
		,[SexualOrientation]
		,[Gender]
		,[Ethnicity]
		,[ValidFrom]
		,[ValidTo]
		,[IsCurrent]
		
		FROM [DV].[Base_Participant_WithHistory]
		) src
WHERE (rn = 1);