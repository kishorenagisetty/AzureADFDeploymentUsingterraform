CREATE VIEW [ADAPT].[PROP_EMPLOYEE_GEN]
AS SELECT [BISUNIQUEID], [REFERENCE], [USER_REF], [PAYROLL], [LST_ACT_DT], [NAME], [EMPLOY_TYPE], [APP_ID], REPLICATE('X',LEN([EMAIL])) AS [EMAIL], [JOB_TITLE], [STATUS], [ValidFrom], [ValidTo], [row_sha2], CAST(1 AS BIT) AS IsCurrent FROM DELTA.ADAPT_PROP_EMPLOYEE_GEN UNION ALL SELECT [BISUNIQUEID], [REFERENCE], [USER_REF], [PAYROLL], [LST_ACT_DT], [NAME], [EMPLOY_TYPE], [APP_ID], REPLICATE('X',LEN([EMAIL])) AS [EMAIL], [JOB_TITLE], [STATUS], [ValidFrom], [ValidTo], [row_sha2], CAST(0 AS BIT) AS IsCurrent FROM DELTA.ADAPT_PROP_EMPLOYEE_GEN_History; 
