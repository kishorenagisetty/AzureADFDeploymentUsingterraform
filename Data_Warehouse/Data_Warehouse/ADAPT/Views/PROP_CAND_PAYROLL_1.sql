CREATE VIEW [ADAPT].[PROP_CAND_PAYROLL]
AS SELECT [BISUNIQUEID], [REFERENCE], [ACC_NUMBER], [BANK_NAME], TRANSLATE([NI_NUMBER],'0123456789','XXXXXXXXXX') AS [NI_NUMBER], [PAY_TYPE], [SORT_CODE], [LTD_COMP_REG], [LTD_COMP_VAT], [BLD_SOC_REF], [PAYROLL_NO], CAST('19000101' AS DATE) AS [TAX_FRM_RECD], [LTD_COMP_NME], [ORIG_ST_DT], [EMP_ST_DT], [P45REQ_REL], [HOL_REQ], [CONT_PAY_TYP], [LTD_COMP_ST1], [LTD_COMP_ST2], [LTD_COMP_LOC], [LTD_COMP_TWN], [LTD_COMP_CTY], [LTD_COMP_PCO], [LTD_COMP_CTR], [LTD_COMP_MAP], [LTD_COMP_SRL], [LTD_COMP_CHK], [NI_TABLE_LET], REPLICATE('X',LEN([TAX_CODE])) AS [TAX_CODE], REPLICATE('X',LEN([TAX_BASIS])) AS [TAX_BASIS], [DATE_JOINED], [DATE_LEFT], [ACC_NAME], 0 AS [AMOUNT], [METH_PAY], [ValidFrom], [ValidTo], [row_sha2], CAST(1 AS BIT) AS IsCurrent FROM DELTA.ADAPT_PROP_CAND_PAYROLL UNION ALL SELECT [BISUNIQUEID], [REFERENCE], [ACC_NUMBER], [BANK_NAME], TRANSLATE([NI_NUMBER],'0123456789','XXXXXXXXXX') AS [NI_NUMBER], [PAY_TYPE], [SORT_CODE], [LTD_COMP_REG], [LTD_COMP_VAT], [BLD_SOC_REF], [PAYROLL_NO], CAST('19000101' AS DATE) AS [TAX_FRM_RECD], [LTD_COMP_NME], [ORIG_ST_DT], [EMP_ST_DT], [P45REQ_REL], [HOL_REQ], [CONT_PAY_TYP], [LTD_COMP_ST1], [LTD_COMP_ST2], [LTD_COMP_LOC], [LTD_COMP_TWN], [LTD_COMP_CTY], [LTD_COMP_PCO], [LTD_COMP_CTR], [LTD_COMP_MAP], [LTD_COMP_SRL], [LTD_COMP_CHK], [NI_TABLE_LET], REPLICATE('X',LEN([TAX_CODE])) AS [TAX_CODE], REPLICATE('X',LEN([TAX_BASIS])) AS [TAX_BASIS], [DATE_JOINED], [DATE_LEFT], [ACC_NAME], 0 AS [AMOUNT], [METH_PAY], [ValidFrom], [ValidTo], [row_sha2], CAST(0 AS BIT) AS IsCurrent FROM DELTA.ADAPT_PROP_CAND_PAYROLL_History;
