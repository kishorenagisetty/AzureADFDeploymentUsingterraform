CREATE VIEW [ADAPT].[PROP_ADDRESS]
AS SELECT [BISUNIQUEID], [OCC_ID], [REFERENCE], REPLICATE('X',LEN([STREET1])) AS [STREET1], REPLICATE('X',LEN([STREET2])) AS [STREET2], [LOCALITY], [TOWN], [COUNTY], [POST_CODE], [COUNTRY], [MAP], [SEARCHLOC], [POSTCODEAREA], [DISTRICT], [SECTOR], [TIMEZONE], [REGION], REPLICATE('X',LEN([STREET3])) AS [STREET3], [NORTHING], [EASTING], [ValidFrom], [ValidTo], [row_sha2], CAST(1 AS BIT) AS IsCurrent FROM DELTA.ADAPT_PROP_ADDRESS UNION ALL SELECT [BISUNIQUEID], [OCC_ID], [REFERENCE], REPLICATE('X',LEN([STREET1])) AS [STREET1], REPLICATE('X',LEN([STREET2])) AS [STREET2], [LOCALITY], [TOWN], [COUNTY], [POST_CODE], [COUNTRY], [MAP], [SEARCHLOC], [POSTCODEAREA], [DISTRICT], [SECTOR], [TIMEZONE], [REGION], REPLICATE('X',LEN([STREET3])) AS [STREET3], [NORTHING], [EASTING], [ValidFrom], [ValidTo], [row_sha2], CAST(0 AS BIT) AS IsCurrent FROM DELTA.ADAPT_PROP_ADDRESS_History;
