CREATE VIEW [ADAPT].[PROP_PERSON_GEN]
AS SELECT [BISUNIQUEID], [REFERENCE], 0 AS [TITLE], REPLICATE('X',LEN([FIRST_NAME])) AS [FIRST_NAME], REPLICATE('X',LEN([MIDDLE_NAME])) AS [MIDDLE_NAME], REPLICATE('X',LEN([LAST_NAME])) AS [LAST_NAME], NULLIF(CASE WHEN LEN([FULLNAME]) <= 2 THEN REPLICATE('X',LEN([FULLNAME])) ELSE CONCAT(LEFT([FULLNAME], 1),REPLICATE('X', LEN([FULLNAME])- 2),RIGHT([FULLNAME],1)) END,'') AS [FULLNAME], [SALUTATION], [PERSON_ID], [INITIALS], [RES_POOL], [JOB_FAMILY], [HR_CONS], [COR_LANG], [CUR_EMPL], [ESS_QCHECK], [OFFLIMIT], [ESS_AUTHCHCK], [DT_OF_BIRTH], [UNDO], [PRAP], [IMPORT_DT], [PRAP_STATUS], [ValidFrom], [ValidTo], [row_sha2], CAST(1 AS BIT) AS IsCurrent FROM DELTA.ADAPT_PROP_PERSON_GEN UNION ALL SELECT [BISUNIQUEID], [REFERENCE], 0 AS [TITLE], REPLICATE('X',LEN([FIRST_NAME])) AS [FIRST_NAME], REPLICATE('X',LEN([MIDDLE_NAME])) AS [MIDDLE_NAME], REPLICATE('X',LEN([LAST_NAME])) AS [LAST_NAME], NULLIF(CASE WHEN LEN([FULLNAME]) <= 2 THEN REPLICATE('X',LEN([FULLNAME])) ELSE CONCAT(LEFT([FULLNAME], 1),REPLICATE('X', LEN([FULLNAME])- 2),RIGHT([FULLNAME],1)) END,'') AS [FULLNAME], [SALUTATION], [PERSON_ID], [INITIALS], [RES_POOL], [JOB_FAMILY], [HR_CONS], [COR_LANG], [CUR_EMPL], [ESS_QCHECK], [OFFLIMIT], [ESS_AUTHCHCK], [DT_OF_BIRTH], [UNDO], [PRAP], [IMPORT_DT], [PRAP_STATUS], [ValidFrom], [ValidTo], [row_sha2], CAST(0 AS BIT) AS IsCurrent FROM DELTA.ADAPT_PROP_PERSON_GEN_History; 


